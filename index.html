<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Kanban Board</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        glass: 'rgba(255, 255, 255, 0.1)',
                        glassBorder: 'rgba(255, 255, 255, 0.2)',
                        accent: '#a855f7', // Purple 500
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background: linear-gradient(-45deg, #0f172a, #312e81, #4c1d95, #0f172a);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Glassmorphism Classes */
        .glass-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .task-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: grab;
        }

        .task-card:hover {
            transform: translateY(-4px) scale(1.02);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            border-color: rgba(168, 85, 247, 0.5);
        }

        .task-card:active {
            cursor: grabbing;
            transform: scale(0.98);
        }

        .task-card.dragging {
            opacity: 0.5;
            transform: scale(0.95);
            border: 2px dashed #a855f7;
        }

        /* Hidden Scrollbar (Functionality remains) */
        /* For Chrome, Safari and Opera */
        .custom-scrollbar::-webkit-scrollbar {
            display: none;
        }

        /* For IE, Edge and Firefox */
        .custom-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        
        /* Also hide for body/html if needed, though mostly handled by container */
        ::-webkit-scrollbar {
            display: none;
        }
        
        html {
            scrollbar-width: none;
        }

        /* Column Styles */
        .column-drop-zone {
            min-height: 200px;
            height: 100%;
            transition: background 0.3s;
            border-radius: 0.75rem;
        }

        .column-drop-zone.drag-over {
            background: rgba(168, 85, 247, 0.15);
            border: 2px dashed rgba(168, 85, 247, 0.5);
        }

        /* Floating particles */
        .particle {
            position: absolute;
            border-radius: 50%;
            background: white;
            opacity: 0.3;
            pointer-events: none;
            z-index: 0;
            animation: floatUp 20s linear infinite;
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) scale(0); opacity: 0; }
            50% { opacity: 0.5; }
            100% { transform: translateY(-100px) scale(1); opacity: 0; }
        }

        /* Checkbox Animation */
        .custom-checkbox:checked + div {
            background-color: #22c55e;
            border-color: #22c55e;
        }
        
        .custom-checkbox:checked + div i {
            opacity: 1;
        }
    </style>
</head>
<body class="selection:bg-purple-500 selection:text-white">

    <!-- Floating Background Particles -->
    <div id="particles-container" class="fixed inset-0 overflow-hidden pointer-events-none"></div>

    <div class="relative z-10 container mx-auto px-4 py-8 max-w-7xl h-screen flex flex-col">
        
        <!-- Header -->
        <header class="mb-8 text-center animate-fade-in-down">
            <h1 class="text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-300 via-pink-300 to-indigo-300 mb-2 drop-shadow-lg tracking-tight">
                Galaxy Tasks
            </h1>
            <p class="text-gray-300 text-sm md:text-base font-light tracking-wide">Drag, drop, and conquer your day.</p>
        </header>

        <!-- Input Section -->
        <div class="mb-8 flex justify-center w-full">
            <div class="glass-panel p-2 rounded-full flex w-full max-w-2xl relative group focus-within:ring-2 focus-within:ring-purple-400 transition-all duration-300">
                <input type="text" id="taskInput" placeholder="What is your next mission?" 
                    class="bg-transparent border-none outline-none text-white placeholder-gray-400 flex-grow px-6 py-3 rounded-l-full text-lg w-full">
                <button onclick="addTask()" 
                    class="bg-purple-600 hover:bg-purple-500 text-white px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center gap-2">
                    <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add Task</span>
                </button>
            </div>
        </div>

        <!-- Board Area -->
        <div class="flex-grow overflow-x-auto overflow-y-auto md:overflow-y-hidden pb-4 custom-scrollbar">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:h-full min-w-[300px]">
                
                <!-- Column: TODO -->
                <div class="glass-panel rounded-2xl flex flex-col h-full max-h-[70vh] md:max-h-full min-h-[50vh]">
                    <div class="p-4 border-b border-glassBorder flex justify-between items-center bg-white/5 rounded-t-2xl">
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 rounded-full bg-red-400 shadow-[0_0_10px_rgba(248,113,113,0.5)]"></div>
                            <h2 class="font-bold text-lg tracking-wide">To Do</h2>
                        </div>
                        <span id="count-todo" class="bg-white/10 px-2 py-0.5 rounded-md text-xs font-mono">0</span>
                    </div>
                    <div class="p-4 flex-grow overflow-y-auto column-drop-zone custom-scrollbar" id="todo" ondrop="drop(event)" ondragover="allowDrop(event)" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)">
                        <!-- Tasks go here -->
                    </div>
                </div>

                <!-- Column: IN PROGRESS -->
                <div class="glass-panel rounded-2xl flex flex-col h-full max-h-[70vh] md:max-h-full min-h-[50vh]">
                    <div class="p-4 border-b border-glassBorder flex justify-between items-center bg-white/5 rounded-t-2xl">
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 rounded-full bg-yellow-400 shadow-[0_0_10px_rgba(250,204,21,0.5)]"></div>
                            <h2 class="font-bold text-lg tracking-wide">In Progress</h2>
                        </div>
                        <span id="count-inprogress" class="bg-white/10 px-2 py-0.5 rounded-md text-xs font-mono">0</span>
                    </div>
                    <div class="p-4 flex-grow overflow-y-auto column-drop-zone custom-scrollbar" id="inprogress" ondrop="drop(event)" ondragover="allowDrop(event)" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)">
                        <!-- Tasks go here -->
                    </div>
                </div>

                <!-- Column: COMPLETED -->
                <div class="glass-panel rounded-2xl flex flex-col h-full max-h-[70vh] md:max-h-full min-h-[50vh]">
                    <div class="p-4 border-b border-glassBorder flex justify-between items-center bg-white/5 rounded-t-2xl">
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 rounded-full bg-green-400 shadow-[0_0_10px_rgba(74,222,128,0.5)]"></div>
                            <h2 class="font-bold text-lg tracking-wide">Completed</h2>
                        </div>
                        <span id="count-done" class="bg-white/10 px-2 py-0.5 rounded-md text-xs font-mono">0</span>
                    </div>
                    <div class="p-4 flex-grow overflow-y-auto column-drop-zone custom-scrollbar" id="done" ondrop="drop(event)" ondragover="allowDrop(event)" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)">
                        <!-- Tasks go here -->
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Confetti Canvas -->
    <canvas id="confetti" class="fixed inset-0 pointer-events-none z-50"></canvas>

    <script>
        // --- Particle Background Generation ---
        const particlesContainer = document.getElementById('particles-container');
        for (let i = 0; i < 20; i++) {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            const size = Math.random() * 5 + 2;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.left = `${Math.random() * 100}vw`;
            particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
            particle.style.animationDelay = `${Math.random() * 5}s`;
            particlesContainer.appendChild(particle);
        }

        // --- State & Initialization ---
        let tasks = JSON.parse(localStorage.getItem('galaxyTasks')) || [];
        
        const columns = {
            todo: document.getElementById('todo'),
            inprogress: document.getElementById('inprogress'),
            done: document.getElementById('done')
        };

        const counts = {
            todo: document.getElementById('count-todo'),
            inprogress: document.getElementById('count-inprogress'),
            done: document.getElementById('count-done')
        };

        function saveTasks() {
            localStorage.setItem('galaxyTasks', JSON.stringify(tasks));
            renderTasks();
        }

        function addTask() {
            const input = document.getElementById('taskInput');
            const text = input.value.trim();
            if (text === '') return;

            const task = {
                id: Date.now().toString(),
                text: text,
                status: 'todo',
                createdAt: new Date().toLocaleDateString()
            };

            tasks.push(task);
            input.value = '';
            saveTasks();
        }

        function deleteTask(id) {
            tasks = tasks.filter(t => t.id !== id);
            saveTasks();
        }

        function moveTaskMobile(id, direction) {
            const taskIndex = tasks.findIndex(t => t.id === id);
            if (taskIndex === -1) return;

            const statusOrder = ['todo', 'inprogress', 'done'];
            let currentStatusIdx = statusOrder.indexOf(tasks[taskIndex].status);
            
            if (direction === 'next' && currentStatusIdx < 2) {
                currentStatusIdx++;
            } else if (direction === 'prev' && currentStatusIdx > 0) {
                currentStatusIdx--;
            }

            const newStatus = statusOrder[currentStatusIdx];
            
            // Trigger confetti if moving to done
            if (newStatus === 'done' && tasks[taskIndex].status !== 'done') {
                fireConfetti();
            }

            tasks[taskIndex].status = newStatus;
            saveTasks();
        }

        function toggleComplete(id) {
            const taskIndex = tasks.findIndex(t => t.id === id);
            if (tasks[taskIndex].status === 'done') {
                tasks[taskIndex].status = 'todo';
            } else {
                tasks[taskIndex].status = 'done';
                fireConfetti();
            }
            saveTasks();
        }

        function renderTasks() {
            // Clear columns
            Object.values(columns).forEach(col => col.innerHTML = '');
            
            // Reset counts
            const currentCounts = { todo: 0, inprogress: 0, done: 0 };

            tasks.forEach(task => {
                currentCounts[task.status]++;
                const card = createTaskElement(task);
                columns[task.status].appendChild(card);
            });

            // Update counters
            counts.todo.innerText = currentCounts.todo;
            counts.inprogress.innerText = currentCounts.inprogress;
            counts.done.innerText = currentCounts.done;
        }

        function createTaskElement(task) {
            const div = document.createElement('div');
            div.className = 'task-card p-4 rounded-xl mb-3 flex flex-col gap-3 group relative';
            div.draggable = true;
            div.id = task.id;
            
            // Drag Events
            div.addEventListener('dragstart', drag);
            
            // Determine arrow visibility based on status
            const showLeft = task.status !== 'todo';
            const showRight = task.status !== 'done';
            const isDone = task.status === 'done';

            div.innerHTML = `
                <div class="flex justify-between items-start gap-3">
                    <div class="flex items-start gap-3 w-full">
                        <label class="cursor-pointer mt-1 relative">
                            <input type="checkbox" class="custom-checkbox hidden" ${isDone ? 'checked' : ''} onchange="toggleComplete('${task.id}')">
                            <div class="w-5 h-5 border-2 border-purple-400 rounded-md flex items-center justify-center transition-all">
                                <i class="fas fa-check text-xs text-white opacity-0 transition-opacity"></i>
                            </div>
                        </label>
                        <p class="text-sm font-medium leading-relaxed ${isDone ? 'line-through text-gray-400' : 'text-gray-100'} break-words w-full">${task.text}</p>
                    </div>
                    <button onclick="deleteTask('${task.id}')" class="text-gray-500 hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100 focus:opacity-100">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
                
                <div class="flex justify-between items-center mt-1">
                    <span class="text-[10px] text-gray-400 font-mono">${task.createdAt}</span>
                    
                    <!-- Mobile Move Controls (Visible on mobile/tablet, smaller on desktop) -->
                    <div class="flex gap-2 md:hidden">
                        ${showLeft ? `<button onclick="moveTaskMobile('${task.id}', 'prev')" class="bg-white/10 hover:bg-white/20 p-1.5 rounded text-xs text-white"><i class="fas fa-chevron-left"></i></button>` : '<div></div>'}
                        ${showRight ? `<button onclick="moveTaskMobile('${task.id}', 'next')" class="bg-white/10 hover:bg-white/20 p-1.5 rounded text-xs text-white"><i class="fas fa-chevron-right"></i></button>` : ''}
                    </div>
                </div>
            `;
            return div;
        }

        // --- Drag and Drop Logic ---

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
            ev.target.classList.add('dragging');
            setTimeout(() => {
                ev.target.style.display = 'none'; // Visual hack to hide original while dragging
            }, 0);
        }

        // Add event listener to reset display if drag ends without drop
        document.addEventListener("dragend", function(event) {
            if (event.target.classList.contains("task-card")) {
                event.target.style.display = "flex";
                event.target.classList.remove("dragging");
                // Remove highlight from all columns
                document.querySelectorAll('.column-drop-zone').forEach(col => {
                    col.classList.remove('drag-over');
                });
            }
        });

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function dragEnter(ev) {
            ev.preventDefault();
            if (ev.currentTarget.classList.contains('column-drop-zone')) {
                ev.currentTarget.classList.add('drag-over');
            }
        }

        function dragLeave(ev) {
            if (ev.currentTarget.classList.contains('column-drop-zone')) {
                ev.currentTarget.classList.remove('drag-over');
            }
        }

        function drop(ev) {
            ev.preventDefault();
            const col = ev.currentTarget;
            col.classList.remove('drag-over');
            
            const data = ev.dataTransfer.getData("text");
            const draggedElement = document.getElementById(data);
            
            if(!draggedElement) return;

            draggedElement.style.display = "flex"; // Restore visibility
            draggedElement.classList.remove("dragging");
            
            // Identify new status
            const newStatus = col.id;
            const taskId = draggedElement.id;

            // Update data model
            const task = tasks.find(t => t.id === taskId);
            
            if (task.status !== newStatus) {
                // If moving to done, fire confetti
                if (newStatus === 'done') {
                    fireConfetti();
                }
                
                task.status = newStatus;
                saveTasks(); // This re-renders everything
            }
        }

        // Input enter key support
        document.getElementById('taskInput').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                addTask();
            }
        });

        // --- Confetti Effect (Simple Implementation) ---
        const canvas = document.getElementById('confetti');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let confettiParticles = [];

        function fireConfetti() {
            for (let i = 0; i < 100; i++) {
                confettiParticles.push({
                    x: Math.random() * canvas.width,
                    y: -10,
                    r: Math.random() * 4 + 1,
                    d: Math.random() * 10 + 10,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    tilt: Math.floor(Math.random() * 10) - 10,
                    tiltAngle: 0,
                    tiltAngleIncremental: (Math.random() * 0.07) + 0.05
                });
            }
            if (confettiParticles.length <= 100) {
                animateConfetti();
            }
        }

        function animateConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confettiParticles.forEach((p, index) => {
                p.tiltAngle += p.tiltAngleIncremental;
                p.y += (Math.cos(p.d) + 3 + p.r / 2) / 2;
                p.x += Math.sin(0);
                p.tilt = Math.sin(p.tiltAngle - (index / 3));
                
                ctx.beginPath();
                ctx.lineWidth = p.r / 2;
                ctx.strokeStyle = p.color;
                ctx.moveTo(p.x + p.tilt + p.r, p.y);
                ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r);
                ctx.stroke();
            });

            // Remove particles off screen
            confettiParticles = confettiParticles.filter(p => p.y < canvas.height);

            if (confettiParticles.length > 0) {
                requestAnimationFrame(animateConfetti);
            }
        }

        // Initial Render
        renderTasks();
        
        // Window resize handler for canvas
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

    </script>
</body>
</html>